##
##   Copyright 2015 Futur Solo
##
##   Licensed under the Apache License, Version 2.0 (the "License");
##   you may not use this file except in compliance with the License.
##   You may obtain a copy of the License at
##
##       http://www.apache.org/licenses/LICENSE-2.0
##
##   Unless required by applicable law or agreed to in writing, software
##   distributed under the License is distributed on an "AS IS" BASIS,
##   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
##   See the License for the specific language governing permissions and
##   limitations under the License.
<%inherit file="framework.htm"/>
<%block name="css">
<link href="${management_url("crda.css")}" rel="stylesheet" type="text/css">
</%block>
${parent.header()}
    <div class="main">
        <div class="container">
            <div class="page-title">${page_title}</div>
            <div class="type-selector">
                <span location="${config["site_url"]}/management/crda/writings">
                    <input id="check-writings" type="radio" name="check-type" ${current_check(area, "writings")}>
                    <label for="check-writings">文章</label>
                </span>
                <span location="${config["site_url"]}/management/crda/pages">
                    <input id="check-pages" type="radio" name="check-type" ${current_check(area, "pages")}>
                    <label for="check-pages">页面</label>
                </span>
                <span location="${config["site_url"]}/management/crda/replies">
                    <input id="check-replies" type="radio" name="check-type" ${current_check(area, "replies")}>
                    <label for="check-replies">评论</label>
                </span>
            </div>
    % if len(list(content.keys())) == 0:
        <div class="float-block">
            <div class="no-content">不要找了，这里什么也没有啦(*'▽')！</div>
        </div>
    % else:
            <div class="float-block">
                <div class="table-header table-item">
                % if area == "writings":
                    <div class="content-title">文章标题</div>
                    <div class="content-time">发表时间</div>
                % elif area == "pages":
                    <div class="content-title">页面标题</div>
                    <div class="content-time">发表时间</div>
                % elif area == "replies":
                    <div class="content-title">评论列表</div>
                % endif
                </div>
        % if area == "writings" or area == "pages":
            % for key in content:
                <div class="table-content table-item">
                    <div class="content-title"><a href="${content[key]["edit_link"]}">${content[key]["title"]}</a></div>
                % if ("publish" in list(content[key].keys())) and (not content[key]["publish"]):
                    <div class="content-draft">草稿</div>
                % endif
                    <div class="content-time change-time">${content[key]["time"]}</div>
                </div>
            % endfor
        % else:
            % for key in content:
                <div class="table-reply-content table-item">
                    <div class="reply-avatar" style="background-image: url(/channel/avatar/${content[key]["emailmd5"]}?s=200&d=mm)"></div>
                    <div class="reply-content">
                        <div class="reply-name">
                            <a href="${content[key]["homepage"]}">${content[key]["name"]}</a>
                        % if not content[key]["permit"]:
                            <span class="reply-notchecked">待审核</span>
                        % endif
                        </div>
                        <div class="reply-privacy">
                            <span class="reply-email"><a href="mailto:${content[key]["email"]}">${content[key]["email"]}</a></span>
                            <span class="reply-ip">${content[key]["ip"]}</span>
                        </div>
                        <div class="reply-time">发表于：<span class="change-time">${content[key]["time"]}</span></div>
                        <div class="reply-body">${content[key]["content"]}</div>
                        <div class="reply-control">
                        % if not content[key]["permit"]:
                            <span class="reply-action permit-reply" reply="${content[key]["_id"]}">通过之</span>
                        % else:
                            <span class="reply-action unpermit-reply" reply="${content[key]["_id"]}">撤销通过</span>
                        % endif
                            <span class="reply-action delete-reply" reply="${content[key]["_id"]}">刪除</span>
                        </div>
                    </div>
                </div>
            % endfor
        % endif
            </div>
    % endif
        </div>
    </div>
${parent.footer()}
<%block name="js">
    <script src="${management_url("crda.js")}" charset="utf-8"></script>
</%block>
<%!
    def current_check(area, this):
        if area == this:
            return "checked"
        return ""
%>
